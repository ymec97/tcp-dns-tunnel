Search.setIndex({"docnames": ["client", "common", "index", "modules", "server"], "filenames": ["client.rst", "common.rst", "index.rst", "modules.rst", "server.rst"], "titles": ["client module", "common module", "Welcome to TCP TUNNEL OVER DNS\u2019s documentation!", "tcp-dns-tunnel", "server module"], "terms": {"side": [0, 4], "tunnel": [0, 4], "thi": [0, 4], "run": [0, 1, 4], "2": [0, 4], "thread": [0, 4], "send_thread": [0, 3], "i": [0, 4], "listen": [0, 4], "tun0": [0, 4], "interfac": 0, "everi": [0, 4], "packet": [0, 4], "read": [0, 3], "from": [0, 1, 4], "creat": [0, 4], "dn": [0, 1, 4], "queri": 0, "concaten": 0, "send": [0, 4], "server": [0, 1, 3], "recv_thread": [0, 3], "ha": [0, 1, 4], "access": 0, "network": 0, "came": 0, "extract": [0, 4], "actual": [0, 4], "answer": 0, "write": [0, 3], "back": [0, 4], "tun": 0, "class": [0, 1, 4], "tuninterfac": [0, 3], "base": [0, 1, 4], "object": [0, 1, 4], "encapsul": [0, 4], "attribut": [0, 4], "_descriptor": 0, "io": 0, "The": [0, 1, 4], "file": 0, "descriptor": 0, "number_byt": 0, "int": 0, "byte": [0, 4], "arg": [0, 4], "number": 0, "return": [0, 1, 4], "we": [0, 1, 4], "none": 0, "represent": 0, "alter_packet_dst": [0, 3], "chang": [0, 4], "dst": 0, "address": [0, 1, 4], "mac": [0, 1, 4], "ip": [0, 1, 4], "function": [0, 4], "us": [0, 1, 4], "get": [0, 4], "ar": [0, 1, 4], "destin": [0, 4], "so": [0, 4], "order": 0, "applic": 0, "host": 0, "accept": 0, "need": [0, 4], "ourselv": 0, "contain": [0, 1, 4], "after": 0, "extract_wrapped_packet_byt": [0, 3, 4], "data": [0, 4], "tcp": [0, 4], "main": [0, 3, 4], "entri": [0, 4], "point": [0, 4], "tcp_wrapper": [], "respons": 4, "wrap": 0, "outgo": [], "traffic": [], "incom": 4, "share": 1, "util": 1, "retriev": 1, "machin": [0, 1], "re": 1, "our": [1, 4], "gatewai": 1, "hold": [0, 1], "magic": [1, 4], "identifi": [1, 4], "massag": 1, "between": 1, "client": [1, 3, 4], "localmachin": [1, 3], "running_as_root": [1, 3], "valid": 1, "root": 1, "privileg": 1, "bool": [1, 4], "whether": [1, 4], "running_from_script": [1, 3], "wa": 1, "call": 1, "within": 1, "sh": 1, "script": 1, "validate_st": [1, 3], "logger": 1, "both": 1, "them": 1, "index": 2, "modul": [2, 3], "search": 2, "page": 2, "common": 3, "tunnelserv": [3, 4], "tunnel_interfac": [3, 4], "add_packet_to_active_sess": [3, 4], "alter_packet_origin": [3, 4], "get_resp_data_from_active_sess": [3, 4], "handle_dns_queri": [3, 4], "handle_real_packet_to_serv": [3, 4], "handle_tcp_respons": [3, 4], "is_for_active_sess": [3, 4], "our_dns_packet": [3, 4], "remove_from_active_sess": [], "serv": [3, 4], "tunnel_response_tcp_packet": [3, 4], "listen_dn": 4, "For": 4, "part": 4, "alter": 4, "src": 4, "listen_tcp": 4, "an": 4, "activ": 4, "session": 4, "wrapp": 4, "source_cli": 4, "local_machin": [0, 4], "dns_bpf_filter": 4, "filter": 4, "inord": 4, "catch": 4, "onli": 4, "tcp_bpf_filter": 4, "active_session_map": 4, "tcp_packet": 4, "Not": [], "sure": 4, "when": 4, "handl": 4, "properli": 4, "updat": 4, "checksum": 4, "accordingli": 4, "readi": 4, "sent": 4, "classmethod": 4, "dns_packet": 4, "want": 4, "If": 4, "look": 4, "one": 4, "real": 4, "ones": 4, "system": 4, "prevent": 4, "automat": 4, "relat": 4, "request": 4, "all": 4, "transfer": 4, "localhost": 4, "pass": 4, "tht": 4, "ot": 4, "appropri": 4, "make": 4, "paramet": 4, "_listen_dn": 4, "_listen_tcp": 4, "tunnelcli": [0, 3], "server_ip": 0, "inform": [0, 4], "local": 0, "clien": [0, 3], "execut": 0, "save": 4, "sourc": 4, "port": 4, "dest": 4, "target": 4, "check": 4, "": 4, "otherwis": 4, "itself": 4, "In": 4, "futur": 4, "specif": 4, "multi": 4, "support": 4}, "objects": {"": [[0, 0, 0, "-", "client"], [1, 0, 0, "-", "common"], [4, 0, 0, "-", "server"]], "client": [[0, 1, 1, "", "TUNInterface"], [0, 1, 1, "", "TunnelClient"], [0, 3, 1, "", "alter_packet_dst"], [0, 3, 1, "", "extract_wrapped_packet_bytes"], [0, 3, 1, "", "main"]], "client.TUNInterface": [[0, 2, 1, "", "read"], [0, 2, 1, "", "write"]], "client.TunnelClient": [[0, 2, 1, "", "clien"], [0, 2, 1, "", "recv_thread"], [0, 2, 1, "", "send_thread"]], "common": [[1, 1, 1, "", "LocalMachine"], [1, 3, 1, "", "running_as_root"], [1, 3, 1, "", "running_from_script"], [1, 3, 1, "", "validate_state"]], "server": [[4, 1, 1, "", "TunnelServer"], [4, 3, 1, "", "main"]], "server.TunnelServer": [[4, 4, 1, "", "TUNNEL_INTERFACE"], [4, 2, 1, "", "add_packet_to_active_session"], [4, 2, 1, "", "alter_packet_origin"], [4, 2, 1, "", "extract_wrapped_packet_bytes"], [4, 2, 1, "", "get_resp_data_from_active_sessions"], [4, 2, 1, "", "handle_dns_query"], [4, 2, 1, "", "handle_real_packet_to_server"], [4, 2, 1, "", "handle_tcp_response"], [4, 2, 1, "", "is_for_active_session"], [4, 2, 1, "", "our_dns_packet"], [4, 2, 1, "", "serve"], [4, 2, 1, "", "tunnel_response_tcp_packet"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"client": 0, "modul": [0, 1, 4], "common": 1, "welcom": 2, "tcp": [2, 3], "tunnel": [2, 3], "over": 2, "dn": [2, 3], "": 2, "document": 2, "indic": 2, "tabl": 2, "server": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"client module": [[0, "module-client"]], "common module": [[1, "module-common"]], "Welcome to TCP TUNNEL OVER DNS\u2019s documentation!": [[2, "welcome-to-tcp-tunnel-over-dns-s-documentation"]], "Indices and tables": [[2, "indices-and-tables"]], "tcp-dns-tunnel": [[3, "tcp-dns-tunnel"]], "server module": [[4, "module-server"]]}, "indexentries": {"tuninterface (class in client)": [[0, "client.TUNInterface"]], "tunnelclient (class in client)": [[0, "client.TunnelClient"]], "alter_packet_dst() (in module client)": [[0, "client.alter_packet_dst"]], "clien() (client.tunnelclient method)": [[0, "client.TunnelClient.clien"]], "client": [[0, "module-client"]], "extract_wrapped_packet_bytes() (in module client)": [[0, "client.extract_wrapped_packet_bytes"]], "main() (in module client)": [[0, "client.main"]], "module": [[0, "module-client"], [1, "module-common"], [4, "module-server"]], "read() (client.tuninterface method)": [[0, "client.TUNInterface.read"]], "recv_thread() (client.tunnelclient method)": [[0, "client.TunnelClient.recv_thread"]], "send_thread() (client.tunnelclient method)": [[0, "client.TunnelClient.send_thread"]], "write() (client.tuninterface method)": [[0, "client.TUNInterface.write"]], "localmachine (class in common)": [[1, "common.LocalMachine"]], "common": [[1, "module-common"]], "running_as_root() (in module common)": [[1, "common.running_as_root"]], "running_from_script() (in module common)": [[1, "common.running_from_script"]], "validate_state() (in module common)": [[1, "common.validate_state"]], "tunnel_interface (server.tunnelserver attribute)": [[4, "server.TunnelServer.TUNNEL_INTERFACE"]], "tunnelserver (class in server)": [[4, "server.TunnelServer"]], "add_packet_to_active_session() (server.tunnelserver method)": [[4, "server.TunnelServer.add_packet_to_active_session"]], "alter_packet_origin() (server.tunnelserver method)": [[4, "server.TunnelServer.alter_packet_origin"]], "extract_wrapped_packet_bytes() (server.tunnelserver class method)": [[4, "server.TunnelServer.extract_wrapped_packet_bytes"]], "get_resp_data_from_active_sessions() (server.tunnelserver method)": [[4, "server.TunnelServer.get_resp_data_from_active_sessions"]], "handle_dns_query() (server.tunnelserver method)": [[4, "server.TunnelServer.handle_dns_query"]], "handle_real_packet_to_server() (server.tunnelserver method)": [[4, "server.TunnelServer.handle_real_packet_to_server"]], "handle_tcp_response() (server.tunnelserver method)": [[4, "server.TunnelServer.handle_tcp_response"]], "is_for_active_session() (server.tunnelserver method)": [[4, "server.TunnelServer.is_for_active_session"]], "main() (in module server)": [[4, "server.main"]], "our_dns_packet() (server.tunnelserver class method)": [[4, "server.TunnelServer.our_dns_packet"]], "serve() (server.tunnelserver method)": [[4, "server.TunnelServer.serve"]], "server": [[4, "module-server"]], "tunnel_response_tcp_packet() (server.tunnelserver method)": [[4, "server.TunnelServer.tunnel_response_tcp_packet"]]}})